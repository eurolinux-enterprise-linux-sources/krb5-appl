diff -Naur krb5-appl-1.0.1/telnet/libtelnet/encrypt.c krb5-appl-1.0.1.CVE-2011-4862/telnet/libtelnet/encrypt.c
--- krb5-appl-1.0.1/telnet/libtelnet/encrypt.c	2009-11-06 01:45:06.000000000 +0530
+++ krb5-appl-1.0.1.CVE-2011-4862/telnet/libtelnet/encrypt.c	2011-12-27 09:36:09.429317041 +0530
@@ -757,6 +757,9 @@
 	int dir = kp->dir;
 	register int ret = 0;
 
+        if (len > MAXKEYLEN)
+                len = MAXKEYLEN;
+
 	if (!(ep = (*kp->getcrypt)(*kp->modep))) {
 		if (len == 0)
 			return;
